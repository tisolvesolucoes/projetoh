 
if(!window.jQuery)
{
   var script = document.createElement('script');
   script.type = "text/javascript";
   script.src = "https://servidorseguro.mysuite2.com.br/client/js/jquery.min.js";
   
   window.onload = function(){
    loadDocument();
   };
   
   document.getElementsByTagName('head')[0].appendChild(script);
} 
else 
    loadDocument();

var bloco_on_fechado, bloco_on_mensagem, bloco_on_dados, janela, atendimentoemcurso;
var mensagem = "";
var on = "";
var hash = "7f5a65fb481643caf0fe2ffb524fa560";
var url = "https://servidorseguro.mysuite2.com.br/client/chatan.php";
var largurapopup = "600";
var alturapopup = "600";
var inf = "";
var minimizou = "";
var si = "fc27f278aaf9b21c529cf0c3034e732b";
var timerChamada;
var sigla = "pc4";
var empresa = "pc4g";
var stylefile = "style.css";


function loadDocument()
{
    jQuery(document).ready(function(){
        if (!atendimentoemcurso)
        {
            jQuery("#divChat #nome").val("");
            jQuery("#divChat #email").val("");
            jQuery("#divChat #setor").val("");

            mostraBalao();
            
            
            timerChamada = setTimeout(function(){
                if (jQuery("#divChat #bloco-on-fechado").length > 0)
                {
                    if (minimizou != 1 && minimizou != true)
                        mostraBlocoOn();
                }
            }, 5000);
            
            
            setClickMinimize();
            setClickBlocoFechado();
            setEnviarMensagem();
            setClickEnviar();

            jQuery("#divChat form").submit(function(e){
                e.preventDefault(); 
            });
            
            setHoverBlocoFechado('');            
        }
    });
}

function importaCss(arrayCss)
{
    for (var i=0; i<arrayCss.length; i++)
    {
        var head  = document.getElementsByTagName('head')[0];
        var link  = document.createElement('link');

        link.rel  = 'stylesheet';
        link.type = 'text/css';
        link.href = arrayCss[i];
        link.media = 'all';

        head.appendChild(link);
    }
}

function importaJs(arrayJs)
{
    for (var i=0; i<arrayJs.length; i++)
    {
        var js = document.createElement("script");
        js.type = "text/javascript";
        js.src = arrayJs[i];

        document.body.appendChild(js);
    }
}

function trataData(data) 
{
    if (data < 10) 
        return "0" + data;
    else 
        return data;
}

function setClickMinimize()
{
    jQuery("#divChat #minimize").click(function(){
        jQuery("#divChat").html(bloco_on_fechado);

        setClickBlocoFechado();
        
        jQuery.ajax({
            type: "POST",
            url: "https://servidorseguro.mysuite2.com.br/client/cf/minimizou.php?si="+si,
            dataType: 'json',
            crossDomain: true,
            xhrFields:{
                withCredentials: true
            },
            data:{

            },
            success: function(data){

            },
            error: function(){

            }
        });        
    });
}

function mostraBalao()
{
    setTimeout(function(){
        jQuery("#divChat .popover").show();

        var d = new Date();
        d = trataData(d.getHours()) + ":" + trataData(d.getMinutes());

        jQuery("#divChat .horaMsg").html(d);
    }, 100);
}

function mostraBlocoOn()
{
    if (!atendimentoemcurso)
    {
        var strHtml;

        if (mensagem == "")
        {
            strHtml = bloco_on_mensagem;
            mostraBalao();
        } 
        else 
            strHtml = bloco_on_dados;

        jQuery("#divChat").html(strHtml);

        setClickMinimize();
        setEnviarMensagem();
        setClickEnviar();        
    }
}

function setClickBlocoFechado()
{
    jQuery("#divChat #bloco-on-fechado").click(function(){
        clearTimeout(timerChamada);

        if (atendimentoemcurso)
        {
            //jQuery("#divChat").html(bloco_final);
            //setClickMinimize();
        } 
        else 
        {
            //jQuery("#divChat").html(bloco_final);
            
            //setClickMinimize();

            jQuery.ajax({
                type: "POST",
                url: "https://servidorseguro.mysuite2.com.br/client/cf/limpa_session.php?si="+si,
                dataType: 'json',
                crossDomain: true,
                xhrFields:{
                    withCredentials: true
                },
                data:{

                },
                success: function(data){

                },
                error: function(){

                }
            });

            var configpop = "width="+largurapopup+" ,height="+alturapopup+" ,scrollbars=yes,resizable=no";
            
            urlChamada = url + "?h=" + hash;
            
            //if (urlChamada.indexOf("https") != -1)
            //{
                //urlChamada = urlChamada.replace("https://servidorseguro", "http://"+empresa);
                urlChamada += '&sl='+sigla;
            //}
            
            if (inf != "")
                urlChamada = urlChamada + "&inf="+inf;

            window.open(urlChamada, "chatonline", configpop);
        }    
    });
}

function setEnviarMensagem()
{    
    jQuery("#divChat #nome").focus();
    
    jQuery("#divChat #formMensagem").submit(function(e){
        e.preventDefault(); 

        if (jQuery("#divChat #inputMsg").val() == "") 
            return false;

        mensagem = jQuery("#divChat #inputMsg").val();
        
        jQuery("#divChat").html(bloco_on_dados);
        
        setClickMinimize();        
        setClickEnviar();
        
        jQuery("#divChat #mensagem").html(mensagem);

        jQuery.ajax({
            type: "POST",
            url: "https://servidorseguro.mysuite2.com.br/client/cf/grava_mensagem.php?si="+si,
            dataType: 'json',
            crossDomain: true,
            xhrFields:{
                withCredentials: true
            },
            data:{
                msg: mensagem
            },
            success: function(data){

            },
            error: function(){

            }
        });
    });
}

function setClickEnviar()
{
    jQuery("#divChat #imgEnviar").click(function(){
        jQuery("#divChat .form-signin").submit();
    });

    jQuery(".form-signin").submit(function(e){    
        e.preventDefault();
        
        var nome = encodeURIComponent(jQuery("#divChat #nome").val());
        
        if (nome == "")
            return false;
        
        if (jQuery("#divChat #email").length > 0 && jQuery("#divChat #email").val() != "") 
            var email = jQuery("#divChat #email").val();
        else 
            var email = "";
        
        var setor = jQuery("#divChat #setor").val();

        mensagem = encodeURIComponent(jQuery("#divChat #mensagem").val());

        var lfa = nome + "_*_" + email + "_*_" + setor + "_*_" + mensagem;        
        var params = "?h=" + hash + "&lfa=" + lfa;
        
        if (inf != "")
            params = params + "&inf="+inf;

        var urlChamada = url + params;
        
        //if (urlChamada.indexOf("https") != -1)
        //{
            //urlChamada = urlChamada.replace("https://servidorseguro", "http://"+empresa);
            urlChamada += '&sl='+sigla;
        //}
        
        var configpop = "width="+largurapopup+" ,height="+alturapopup+" ,scrollbars=yes,resizable=no";

        janela = window.open(urlChamada, "chatonline", configpop);
        
        jQuery("#divChat").html(bloco_final);
        
        setClickMinimize();
        
        jQuery.ajax({
            type: "POST",
            url: "https://servidorseguro.mysuite2.com.br/client/cf/limpa_session.php?si="+si,
            dataType: 'json',
            crossDomain: true,
            xhrFields:{
                withCredentials: true
            },
            data:{
                
            },
            success: function(data){

            },
            error: function(){

            }
        });
        
        return false;
    });
}

function setHoverBlocoFechado(msgDirecionamento)
{
    if (msgDirecionamento != "")
    {    
        setTimeout(function(){
            jQuery('#divChat .status-offline').hover(
                function(){
                    var jQuerythis = jQuery(this); // caching jQuery(this)
                    jQuerythis.data('initialText', jQuerythis.find('label').text());
                    jQuerythis.find('label').text(msgDirecionamento);
                },
                function(){
                    var jQuerythis = jQuery(this); // caching jQuery(this)
                    jQuerythis.find('label').text(jQuerythis.data('initialText'));
                }
            );
        }, 400);
    }
}

css = new Array('https://servidorseguro.mysuite2.com.br/client/cf/css/' + 'style.css');
importaCss(css);

//js = new Array('https://servidorseguro.mysuite2.com.br/client/js/jquery.min.js');
//importaJs(js);

div = document.createElement("div");
div.style.width = 200+"px"; 
div.style.height = 40+"px"; 
div.style.bottom = "0";
div.style.position = "fixed";
div.style.left = "0";
div.style.zindex =  1000;
div.setAttribute("id", "divChat");
divTemp = document.createElement("div");

bloco_on_fechado = '<div id="bloco-on-fechado" class="plugin-atendimento bloco-on-fechado">\
   <label style="">Chat Online!</label>\
</div>';
bloco_off_fechado = '    <div class="bloco-status status-offline">\
           <label style="font-family: Verdana,Geneva,sans-serif; font-size: 12px; font-weight: bold; line-height: 30px; color: #ffffff; font-weight: bold; ">Chat Offline!</label>\
    </div>\
';
bloco_on_mensagem = '<div id="bloco_on_mensagem" class="plugin-atendimento bloco_on_aberto bloco_on_mensagem" >\
    <div class="cabecalho" style="background-color: #e77e23;">\
        <span class="text-atendimento" style="color: #FFFFFF;">\
            Atendimento Online\
        </span>\
        <div id="minimize">\
            <div class="minimize"></div>\
        </div>\
    </div>\
    <div class="cf_content"  >\
        <div class="form-control divConversa" id="divConversa">\
            <div id="1443807990055_1_1443807990547_2" class="popover right limit">\
                <div class="arrow"></div>\
                <div class="popover-content">\
                    <div class="divNomeConversa">\
                        Consultor Online\
                    </div>\
                    <div class="clear"></div>\
                    <div class="triangle-border bubble-alt">\
                        Olá, tudo bem? Em que podemos ajudar?\
                        <div class="footerMsg">\
                            <span class="horaMsg">13:46</span>\
                        </div>\
                    </div>\
                </div>\
            </div>\
            <div class="clear"></div>\
        </div>\
    </div>\
    <div class="chatflutrodape">\
        <form id="formMensagem" method="post">\
            <input class="input-mensagem" id="inputMsg" type="text" placeholder="Digite sua mensagem" value="" />\
        </form>\
    </div>\
    <div style="background-color: #f5f5f5;     bottom: 0;    height: 27px;     position: absolute;     width: 100%;">\
        <div style="height: 2px;     margin: 0;     padding: 0;     width: 100%; background-color: #133f6b;" class="linha-bottom"></div>\
        <div style="margin-left: auto;     margin-right: auto;     padding-left: 15px;     padding-right: 15px;">\
            <div style="margin-left: -15px;     margin-right: -15px;" class="row rowDivTopo">\
                <div style="float: right !important;" class="bg-bottom-menu pull-right">\
                    <span style="font-size: 10px;">Desenvolvido por:</span><a href="http://www.mysuite.com.br/" target="_blank"><img style="height: 25px; width: auto; vertical-align: middle; display: inline;" src="https://servidorseguro.mysuite2.com.br/client/img/mysuite-logo-25.png"></a>\
                </div>\
            </div>\
        </div>\
    </div>\
</div>';
bloco_on_dados = '<div id="bloco_on_mensagem" class="plugin-atendimento bloco_on_aberto bloco_on_dados"  >\
    <div class="cabecalho" style="background-color: #e77e23;">\
        <span class="text-atendimento" style="color: #FFFFFF;">\
            Atendimento Online\
        </span>\
        <div id="minimize">\
            <div class="minimize"></div>\
        </div>\
    </div>\
    <div class="cf_content"  >\
        <div class="limit bloco-login">\
             <form class="form-signin">\
                 <div class="divCamposLogin">\
                <label class="lblDados">Qual o seu nome?</label>\
                <input type="text" class="input-dados" name="nome" id="nome" placeholder="Digite seu nome" value="" style="" />\
                </div>\
                                    <input type="text" placeholder="Email" class="input-dados" id="email" value="">\
                                \
                                    <select class="input-dados" nomecampo="Setor" id="setor" required>\
                        <option value="">Selecione um setor</option>\
                                                                                    <option value="14">Banco Central</option>\
                                                            <option value="88">Banco Central - Cadastro CADEMP PJ Estrangeira</option>\
                                                            <option value="87">Banco Central - Cadastro CADEMP PJ Nacional</option>\
                                                            <option value="84">Banco Central - Credenciamento Sisbacen</option>\
                                                            <option value="86">Banco Central - Gerente Setorial</option>\
                                                            <option value="85">Banco Central - Senha Master</option>\
                                                            <option value="12">Cartório de Titulos e Documentos</option>\
                                                            <option value="66">Cartório de Titulos e Documentos - Al. Fiduciária</option>\
                                                            <option value="65">Cartório de Titulos e Documentos - Ato Societário</option>\
                                                            <option value="70">Cartório de Titulos e Documentos - Promessa Cessão</option>\
                                                            <option value="67">Cartório de Titulos/Documentos - Contrato Licença</option>\
                                                            <option value="77">Cartório Titulos/Documento - Contrato Distribuição</option>\
                                                            <option value="81">Cartório Titulos/Documentos - Busca Nome</option>\
                                                            <option value="72">Cartório Titulos/Documentos - Cessão de Créditos</option>\
                                                            <option value="71">Cartório Titulos/Documentos - Compra e Venda Bens</option>\
                                                            <option value="73">Cartório Titulos/Documentos - Confissão Divida</option>\
                                                            <option value="69">Cartório Titulos/Documentos - Contrato Construção</option>\
                                                            <option value="79">Cartório Titulos/Documentos - Contrato Empréstimo</option>\
                                                            <option value="68">Cartório Titulos/Documentos - Contrato Honorários</option>\
                                                            <option value="76">Cartório Titulos/Documentos - Contrato Patrocinio</option>\
                                                            <option value="75">Cartório Titulos/Documentos - Declaração Vontade</option>\
                                                            <option value="74">Cartório Titulos/Documentos - Diploma</option>\
                                                            <option value="80">Cartório Titulos/Documentos - Inteiro Teor</option>\
                                                            <option value="83">Cartório Titulos/Documentos - Procuração</option>\
                                                            <option value="78">Cartório Titulos/Documentos - Registro Caução</option>\
                                                            <option value="82">Cartório Titulos/Documentos - Registro Especifico</option>\
                                                            <option value="64">Certificado Digital - Conectividade Social</option>\
                                                            <option value="63">Certificado Digital - CT-e</option>\
                                                            <option value="61">Certificado Digital - e-CNPJ</option>\
                                                            <option value="62">Certificado Digital - NF-e</option>\
                                                            <option value="17">Junta Comercial - Abertura Empresa</option>\
                                                            <option value="42">Junta Comercial - Arquivamento de Ato Societário</option>\
                                                            <option value="49">Junta Comercial - Arquivamento de Debêntures</option>\
                                                            <option value="44">Junta Comercial - Arquivamento de Jornais</option>\
                                                            <option value="43">Junta Comercial - Arquivamento de Procuração</option>\
                                                            <option value="48">Junta Comercial - Confecção Livro/Folhas/Registro</option>\
                                                            <option value="22">Junta Comercial - Encerramento de Empresa</option>\
                                                            <option value="45">Junta Comercial - Proteção de Nome Empresarial</option>\
                                                            <option value="47">Junta Comercial - Registro de Livro Societário</option>\
                                                            <option value="16">Junta Comercial - Regularização de Empresa</option>\
                                                            <option value="46">Junta Comercial - Transcrição de Livro Societário</option>\
                                                            <option value="36">Licenças - Alvará Vigilância Sanitária</option>\
                                                            <option value="35">Licenças - Alvará/Licença Funcionamento</option>\
                                                            <option value="34">Licenças - CETESB</option>\
                                                            <option value="38">Licenças - Ministério do Exército</option>\
                                                            <option value="40">Licenças - Policia Civil</option>\
                                                            <option value="39">Licenças - Policia Federal</option>\
                                                            <option value="41">Licenças - SISCOMEX/RADAR</option>\
                                                            <option value="37">Linceças - Alvará Corpo Bombeiros</option>\
                                                            <option value="32">Obtenção - Certidões Administrativas</option>\
                                                            <option value="33">Obtenção - Certidões Cadastrais</option>\
                                                            <option value="50">Obtenção - Certidões Cartoriais</option>\
                                                            <option value="29">Obtenção - Certidões Estaduais</option>\
                                                            <option value="30">Obtenção - Certidões Federais</option>\
                                                            <option value="31">Obtenção - Certidões Forenses</option>\
                                                            <option value="23">Obtenção - Certidões Municipais</option>\
                                                            <option value="26">Órgãos Governamentais - Abertura Empresa</option>\
                                                            <option value="52">Órgãos Governamentais - Alteração Cadastro Fiscal</option>\
                                                            <option value="53">Órgãos Governamentais - Atendimento de Notificação</option>\
                                                            <option value="54">Órgãos Governamentais - Atendimento Fiscalização</option>\
                                                            <option value="55">Órgãos Governamentais - Consularização Documentos</option>\
                                                            <option value="60">Órgãos Governamentais - CPOM</option>\
                                                            <option value="28">Órgãos Governamentais - Encerramento de Empresa</option>\
                                                            <option value="56">Órgãos Governamentais - Imunidade/Isenção Impostos</option>\
                                                            <option value="59">Órgãos Governamentais - Legal. Minist. Relações Ex</option>\
                                                            <option value="58">Órgãos Governamentais - Legalização Consular</option>\
                                                            <option value="51">Órgãos Governamentais - Obtenção Cadastro Fiscal</option>\
                                                            <option value="57">Órgãos Governamentais - Registro Estrangeiro</option>\
                                                            <option value="27">Órgãos Governamentais - Regularização Empresa</option>\
                                                            <option value="25">Regularização Sócio PF/PJ</option>\
                                                                        </select>\
                                 <div style="display: none;" class="alert"></div>\
                 <textarea class="input-dados" id="mensagem"></textarea>\
            </form>\
        </div>\
    </div>\
    <div class="chatflutrodape">\
        <input style="background-color: #e77e23; color: #FFFFFF;" class="btEnviar" id="imgEnviar" type="submit" value="OK">\
   </div>\
   <div style="background-color: #f5f5f5;     bottom: 0;     min-height: 25px;     position: absolute;  width: 100%;">\
        <div style="height: 2px;     margin: 0;     padding: 0;     width: 100%; background-color: #133f6b;" class="linha-bottom"></div>\
        <div style="margin-left: auto;     margin-right: auto;     padding-left: 15px;     padding-right: 15px;">\
            <div style="margin-left: -15px;     margin-right: -15px;" class="row rowDivTopo">\
                <div style="float: right !important;" class="bg-bottom-menu pull-right">\
                    <span style="font-size: 10px;">Desenvolvido por:</span><a href="http://www.mysuite.com.br/" target="_blank"><img style="height: 25px; width: auto; vertical-align: middle; display: inline;" src="https://servidorseguro.mysuite2.com.br/client/img/mysuite-logo-25.png"></a>\
                </div>\
            </div>\
        </div>\
    </div>\
</div>';
bloco_final = '<div id="bloco_on_mensagem" class="plugin-atendimento bloco_on_aberto bloco_on_dados"  >\
    <div class="cabecalho" style="background-color: #e77e23;">\
        <span class="text-atendimento" style="color: #FFFFFF;">\
            Atendimento Online\
        </span>\
        <div id="minimize">\
            <div class="minimize"></div>\
        </div>\
    </div>\
    <div class="cf_content"  >\
        <div class="limit bloco-login">\
                            O atendimento continuará em outra janela                    </div>\
    </div>\
    <div style="background-color: #f5f5f5;     bottom: 0;     min-height: 25px;     position: absolute;     width: 100%;">\
        <div style="height: 2px;     margin: 0;     padding: 0;     width: 100%; background-color: #133f6b;" class="linha-bottom"></div>\
        <div style="margin-left: auto;     margin-right: auto;     padding-left: 15px;     padding-right: 15px;" class="container">\
            <div style="margin-left: -15px;     margin-right: -15px;" class="row rowDivTopo">\
                <div style="float: right !important;" class="bg-bottom-menu pull-right">\
                    <span style="font-size: 10px;">Desenvolvido por:</span><a href="http://www.mysuite.com.br/" target="_blank"><img style="height: 25px; width: auto; vertical-align: middle; display: inline;" src="https://servidorseguro.mysuite2.com.br/client/img/mysuite-logo-25.png"></a>\
                </div>\
            </div>\
        </div>\
    </div>\
</div>';

    div.innerHTML = bloco_off_fechado;

document.body.appendChild(div); 

if(window.jQuery){
    setClickBlocoFechado();
}